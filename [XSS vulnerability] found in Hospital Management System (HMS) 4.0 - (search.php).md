# [XSS vulnerability] found in Hospital Management System (HMS) 4.0 - (search.php)

Affected Project: **Hospital Management System (HMS)**

Platform: Web/Php

Vendor: PHPGurukul

Official Website: (https://phpgurukul.com/hospital-management-system-in-php/)

Version: 4.0

Updated: 16 May 2024

Vulnerable path/file: `hms/doctor/search.php`

Injection parameter: `searchdata`

<br />

Size: 16.7 MB

Sha256: 705263fd0533fde4c8c4d332bf943ea66de98645262cc896f415c897e824455a

<br />

## Vulnerability Description:
The code is vulnerable in search.php because it directly outputs user input `($_POST['searchdata'])` into the HTML without any form of sanitization or encoding. This means that if a user submits HTML or JavaScript code within these fields, it will be rendered directly in the HTML output, executing any embedded JavaScript.
This allows an attacker to inject arbitrary HTML or JavaScript code leading to an XSS attack.

<br />

## Vulnerable code:
```
if(isset($_POST['search']))
{ 

$sdata=$_POST['searchdata'];
  ?>
<h4 align="center">Result against "<?php echo $sdata;?>" keyword </h4>
```

<br />

## Injection Payload Tested:

```
<script>alert('XSS')</script>
```

<br />

## Execution:

When the browser parses the payload `<script>alert('XSS')</script>` code, results in a popup displaying `"XSS"`.

<br />

## Demonstration:

Below is how `search.php` looks like:

<br />

![search.php](https://i.postimg.cc/KjpFrrBg/1.png)

In the `Search by Name/Mobile No.` we need to add our payload `"></script><script>alert('XSS')</script>` and then click the `Search` button to trigger the XSS popup.

<br />

![xss](https://i.postimg.cc/52C1Lz06/3.png)


This is how the request looks like:

![xss](https://i.postimg.cc/MGJwDGMt/2.png)



## Recommendation for Preventing XSS:

To fix this vulnerability, we must always sanitize user inputs before rendering them in the HTML. We can use functions like htmlspecialchars() in PHP to encode special characters.

<br />

Example:
```
if (isset($_POST['search'])) { 
    $sdata = htmlspecialchars($_POST['searchdata'], ENT_QUOTES, 'UTF-8');
    echo "<h4 align='center'>Result against \"$sdata\" keyword </h4>";
}
```

<br />

> One Click Can Change Everything: Be Secure.
